% Apply force to a clamped fiber (force sweep)
% Brady Berg, 2024-01-17

set simul system
{
    time_step = 0.005
    viscosity = 0.01
}

set space cell
{
    shape = rectangle
}

new cell
{
    length = 20,20
}

% sweep over forces

% fiber class "1"
set fiber filament
{
    rigidity = 1e3
    segmentation = 0.1
    confine = inside, 200, cell
    activity = none
    plus_end_force = 3.7 0    % apply force at plus end towards the right
}

% fiber class "2"
% fiber type to be anchored to the bottom of simulation space
set fiber base_fiber
{
    rigidity = 1e6
    segmentation = 0.5
    confine = inside,0
    min_length = 20
    activity = none
}

% define anchoring object
set hand strong_hand
{
    unbinding_rate = 0
    unbinding_force = 1e6
    display = ( size = 10 )
}

set single pivot
{
    hand = strong_hand
    stiffness = 1000
    activity = fixed
}

% define crosslinker to hold fibers at 90degree angles
set couple fork
{
    flip = 0
    hand1 = strong_hand
    hand2 = strong_hand
    diffusion = 0
    stiffness = 1000
    activity = fork
    torque = 1e9, 4.7124   % 3pi/2 radians
}

new 1 base_fiber
{
    length = 20
    position = 0 -10 0
    orientation = -1 0 0    % "point" fiber to the left
    % syntax below is `attach# = [object] [distance from reference to other end] [reference]
    attach1 = pivot, 0, minus_end
    attach2 = pivot, 2, minus_end
    attach3 = pivot, 4, minus_end
    attach4 = pivot, 6, minus_end
    attach5 = pivot, 8, minus_end
    attach6 = pivot, 10, minus_end
    attach7 = pivot, 12, minus_end
    attach8 = pivot, 14, minus_end
    attach9 = pivot, 16, minus_end
    attach10 = pivot, 18, minus_end
    attach11 = pivot, 0, plus_end
}

new 1 filament
{
    length = 10
    position = 0 -5 0     % place fiber in bottom half of cell along midline
    orientation = 0 1 0     % "point" fiber up
    attach1 = pivot, 0, minus_end   % pin the bottom end at its minus end (at the base)
}


new 1 fork
{
    % attach the fork to the middle of the base_fiber and bottom end of "beam" fiber
    attach1 = base_fiber1, 10
    attach2 = filament1, 0
}

run 1000 system
{
    nb_frames = 100
}
